<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Collect Your Gaming Tools - Login</title>
    <link rel="shortcut icon" href="logo.png" type="image/x-icon">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&family=Roboto:wght@400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="login.css">
    <script src="auth.js" defer type="module"></script>
</head>
<body>
    <div class="button-container">
        <a href="../index.html" class="back-button">← Back</a>
    </div>
    <div class="login-container">
        <div class="login-box">
            <h1 class="login-title">Welcome to Gaming Tools Store!</h1>
            <p class="subtitle">Enter your credentials to continue shopping for the best gaming gear.</p>
            <form id="login-form" method="post">
                <div class="input-group">
                    <label for="gmail">Gmail</label>
                    <input type="text" id="gmail" name="username" placeholder="Enter your mail-id" required>
                </div>
                <div class="input-group password-container">
                    <label for="password">Password</label>
                    <input type="password" id="password" placeholder="Enter your password" required>
                    <i class="far fa-eye" id="togglePassword" aria-label="Toggle password visibility"></i>
                </div>
                <button type="submit" class="login-button">Login</button>
                <button id="google-login-btn" type="button" style="display: flex; align-items: center; padding: 10px 15px; border: none; background-color: #4285F4; color: white; font-weight: bold; border-radius: 5px; cursor: pointer;">
                    <img src="https://th.bing.com/th?id=OIP.oiwYjOqBvHy3I_LfVxRblAHaHa&w=250&h=250&c=8&rs=1&qlt=90&o=6&dpr=1.5&pid=3.1&rm=2" alt="Google logo" style="width: 20px; height: 20px; margin-right: 10px;">
                    Login with Google
                </button>
                
            </form>
            <div class="links">
                <a href="forgot.html" class="hal2">Forgot Password?</a>
                <a href="../SignUp/signup.html" class="hal">Sign Up</a>
            </div>
        </div>
    </div>
    <footer class="footer" style="background-color: #2b2b2b; color: #fff; padding: 10px 0; text-align: center; font-family: Arial, sans-serif;">
        <ul class="social-icon" style="display: flex; justify-content: center; list-style: none; padding: 0; margin-bottom: 5px;">
            <li class="social-icon__item" style="margin: 0 8px;">
                <a class="social-icon__link" href="#" style="color: #fff; font-size: 20px; transition: color 0.3s, transform 0.3s;">
                    <ion-icon name="logo-facebook"></ion-icon>
                </a>
            </li>
            <li class="social-icon__item" style="margin: 0 8px;">
                <a class="social-icon__link" href="#" style="color: #fff; font-size: 20px; transition: color 0.3s, transform 0.3s;">
                    <ion-icon name="logo-twitter"></ion-icon>
                </a>
            </li>
            <li class="social-icon__item" style="margin: 0 8px;">
                <a class="social-icon__link" href="#" style="color: #fff; font-size: 20px; transition: color 0.3s, transform 0.3s;">
                    <ion-icon name="logo-linkedin"></ion-icon>
                </a>
            </li>
            <li class="social-icon__item" style="margin: 0 8px;">
                <a class="social-icon__link" href="#" style="color: #fff; font-size: 20px; transition: color 0.3s, transform 0.3s;">
                    <ion-icon name="logo-instagram"></ion-icon>
                </a>
            </li>
        </ul>
        <div class="divider" style="border-top: 1px solid #555; margin: 10px 0;"></div>
        <ul class="menu" style="display: flex; justify-content: center; list-style: none; padding: 0; margin-bottom: 5px;">
            <li class="menu__item" style="margin: 0 10px;">
                <a class="menu__link" href="../index.html" style="color: #e0e0e0; font-size: 16px; font-weight: bold; text-decoration: none; padding: 5px 10px; border-radius: 4px; transition: background-color 0.3s;">
                    Home
                </a>
            </li>
            <li class="menu__item" style="margin: 0 10px;">
                <a class="menu__link" href="" style="color: #e0e0e0; font-size: 16px; font-weight: bold; text-decoration: none; padding: 5px 10px; border-radius: 4px; transition: background-color 0.3s;">
                    About
                </a>
            </li>
            <li class="menu__item" style="margin: 0 10px;">
                <a class="menu__link" href="../index.html#controller" style="color: #e0e0e0; font-size: 16px; font-weight: bold; text-decoration: none; padding: 5px 10px; border-radius: 4px; transition: background-color 0.3s;">
                    Services
                </a>
            </li>
            <li class="menu__item" style="margin: 0 10px;">
                <a class="menu__link" href="../Contributors/contributor.html" style="color: #e0e0e0; font-size: 16px; font-weight: bold; text-decoration: none; padding: 5px 10px; border-radius: 4px; transition: background-color 0.3s;">
                    Team
                </a>
            </li>
            <li class="menu__item" style="margin: 0 10px;">
                <a class="menu__link" href="../index.html#contact" style="color: #e0e0e0; font-size: 16px; font-weight: bold; text-decoration: none; padding: 5px 10px; border-radius: 4px; transition: background-color 0.3s;">
                    Contact
                </a>
            </li>
        </ul>
        <div style="border-top: 2px dashed #444; width: 80%; margin: 10px auto;"></div>
        <p style="font-size: 12px; color: #bbb; margin-top: 10px;">
            ©2024 Collect your Gaming Tools | All Rights Reserved
        </p>
    </footer>
    
    <!-- Inline CSS for hover effects and animations -->
    <style>
        .social-icon__link:hover {
            color: #ff5722;
            transform: scale(1.2);
        }
    
        .menu__link:hover {
            background-color: #ff5722;
            color: #fff;
        }
    
        /* Responsive styling */
        @media (max-width: 768px) {
            .social-icon, .menu {
                flex-direction: column;
            }
            .social-icon__item, .menu__item {
                margin: 5px 0;
            }   
        }
    </style>
    
    <script>
        const togglePassword = document.getElementById('togglePassword');
        const passwordInput = document.getElementById('password');

        togglePassword.addEventListener('click', function () {
            const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
            passwordInput.setAttribute('type', type);
            this.classList.toggle('fa-eye-slash');
        });

        document.getElementById("login-form").addEventListener("submit", async (e) => {
            e.preventDefault();
            const email = document.querySelector("#gmail").value;
            const password = document.querySelector("#password").value;

            const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
            if (!emailPattern.test(email)) {
                alert("Please enter a valid email address.");
                return;
            }
            
            const userData = { email, password };
            await loginUser(userData);
        });

        const loginUser = async (user) => {
            try {
                const res = await fetch("http://localhost:5000/auth/signin", {
                    method: "POST",
                    credentials: "include",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(user)
                });

                const data = await res.json();
                if (res.ok) {
                    window.location.href = "../index.html"; // Updated URL
                } else {
                    alert(data.message);
                }
            } catch (e) {
                alert('Error: ' + e.message);
            }
        };
    </script>
</body>
</html